<!DOCTYPE html>
<html style="height: 100%">

<head>
    <meta charset="utf-8">
</head>

<body style="height: 100%; margin: 0">
    <h1>CAMERA STREAMING</h1>
    <img src='http://192.168.31.80:5555/img' />
    <div id="container" style="height: 100%"></div>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
    <script type="text/javascript">
        var dom = document.getElementById("container");
        var myChart = echarts.init(dom, 'dark');
        var x = [];
        var y = [];

        var option = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross'
                },
                backgroundColor: 'rgba(255, 255, 255, 0.8)',

            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: x
            },
            yAxis: {
                boundaryGap: [0, '50%'],
                type: 'value',
                min: function (value) {
                    return -45;
                },
                max: function (value) {
                    return 45;
                }
            },
            series: [
                {
                    name: 'delta_x',
                    type: 'line',
                    smooth: false,
                    symbol: 'none',
                    data: y
                }
            ]
        };
        myChart.setOption(option);

        setInterval(function () {

            $.get('http://192.168.31.80/aim.json').done(function (data) {
                // 填入数据
                data = jQuery.parseJSON(data);

                for (j = 0, len = data.categories.length; j < len; j++) {
                    x.push(data.categories[j]);
                    y.push(data.data[j]);
                }
                while (x[x.length - 1] - x[0] > 15000) {
                    x.shift();
                    y.shift();
                }
                myChart.setOption({
                    xAxis: {
                        data: x
                    },
                    series: [{
                        name: 'delta_x',
                        data: y
                    }]
                });
            });
        }, 50);
    </script>
</body>

</html>